"use strict";function _interopRequireDefault(r){return r&&r.__esModule?r:{"default":r}}function parse(r){var t=[],e=/\[([a-zA-Z0-9#\/]+)\]/g,s=/^{.*}/,n=/^#/;return r.split("\n").forEach(function(r){var o;if(r.match(n));else if(r.match(s));else if(r.match(e)){for(var c,i={type:"lyrics",lyrics:"",chords:[]},l=0;c=e.exec(r);){o=r.substring(l,c.index),o&&(i.lyrics+=o);var a=0;if(i.chords.length>0){var h=i.chords[i.chords.length-1];a=Math.max(0,h.pos+h.chord.length+1-i.lyrics.length)}for(var u=0;a>u;u++)i.lyrics+=" ";var f=c[0];i.chords.push({pos:i.lyrics.length,chord:f.replace(/[\[\]]/g,"")}),l=c.index+f.length}o=r.substring(l,r.length),o&&(i.lyrics+=o),i.lyrics=i.lyrics.replace(/\s+$/,""),t.push(i)}else t.push({type:"lyrics",lyrics:r,chords:[]})}),t}function formatLyricsEntry(r,t,e){function s(r,t){var s=r.replace(/(<([^>]+)>)/gi,""),n=t.pos-s.length;n>0&&(r+=Array(n+1).join(" "));var o=t.chord;return e&&(o=e(o)),r+=o}var n="";if(r.chords.length>0){var o="";r.chords.forEach(function(r){o=s(o,r)}),n+=o}return(r.lyrics.length>0||0===r.chords.length)&&(n.length>0&&(n+=t),n+=r.lyrics),n}function format(r,t,e){var s=parse(r),n="";return s.forEach(function(r){"lyrics"===r.type&&(n.length>0&&(n+=t),n+=formatLyricsEntry(r,t,e))}),n}function toText(r){return format(r,"\n")}function toHtml(r,t){t||(t={}),t.chordFormatter||(t.chordFormatter=function(r){return"<b>"+r+"</b>"});var e="<pre>";return t["class"]&&(e='<pre class="'+t["class"]+'">'),(0,_sanitizeHtml2["default"])(e+format(r,"<br/>",t.chordFormatter)+"</pre>",{allowedAttributes:{pre:["class"]}})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.parse=parse,exports.toText=toText,exports.toHtml=toHtml;var _sanitizeHtml=require("sanitize-html"),_sanitizeHtml2=_interopRequireDefault(_sanitizeHtml);